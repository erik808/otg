function [graph, map, V, D] = main(adjfile, mapfile)

  graph = sparse(load(adjfile));

  A1 = graph;  
  A2 = A1 + (A1^2)/2;
  A3 = A2 + (A1^3)/6;
  A4 = A3 + (A1^4)/24;

  figure(1)
  subplot(2,2,1)
  spy(A1, 'k.');
  subplot(2,2,2)
  spy(A2 + 0.5*graph*graph, 'k.');		   
  subplot(2,2,3)
  spy(A3, 'k.');		   
  subplot(2,2,4)
  spy(A4, 'k.');		   
  
  [V,D] = eigs(A1,6,'lm');

  % principal eigenvector
  ev = V(:,1);
  mx = max(abs(ev));
  mn = min(abs(ev));

  threshold = mn+.7*(mx-mn);
  id        = find(abs(ev) > threshold);
  
  map   = importdata(mapfile);

  figure(2)
  plot(map.data, abs(ev), map.data, threshold, 'r')
  hold on
  plot(map.data(id), abs(ev(id)), 'ro')
  hold off
  
  for i = id'
	  disp(i)
	  disp(id)
	  fprintf('%s - %f \n', map.textdata{i}, abs(ev(i)));
  end 
  
end
